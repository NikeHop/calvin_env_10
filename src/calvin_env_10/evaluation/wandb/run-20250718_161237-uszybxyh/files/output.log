logging to eval_log
1/5 : 0.0% | 2/5 : 0.0% | 3/5 : 0.0% | 4/5 : 0.0% | 5/5 : 0.0% ||:   1%|â–Ž                                              | 7/1000 [00:14<34:31,  2.09s/it]
{'led': 1, 'lightbulb': 1, 'slider': 'left', 'drawer': 'open', 'red_block': 'slider_left', 'blue_block': 'table', 'pink_block': 'slider_right', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: rotate_blue_block_right
Video saved to: eval_log/trajectory_0.mp4
{'led': 1, 'lightbulb': 1, 'slider': 'right', 'drawer': 'open', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'slider_left', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: turn_off_led
Video saved to: eval_log/trajectory_1.mp4
{'led': 0, 'lightbulb': 1, 'slider': 'right', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'slider_right', 'pink_block': 'slider_left', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: lift_pink_block_slider
Video saved to: eval_log/trajectory_2.mp4
{'led': 1, 'lightbulb': 0, 'slider': 'right', 'drawer': 'closed', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'table', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: rotate_blue_block_right
Video saved to: eval_log/trajectory_3.mp4
{'led': 1, 'lightbulb': 0, 'slider': 'left', 'drawer': 'closed', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'table', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: open_drawer
Video saved to: eval_log/trajectory_4.mp4
{'led': 1, 'lightbulb': 1, 'slider': 'left', 'drawer': 'open', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'table', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: push_blue_block_left
Video saved to: eval_log/trajectory_5.mp4
{'led': 0, 'lightbulb': 0, 'slider': 'right', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'slider_left', 'pink_block': 'table', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: open_drawer
Video saved to: eval_log/trajectory_6.mp4
{'led': 0, 'lightbulb': 0, 'slider': 'left', 'drawer': 'open', 'red_block': 'table', 'blue_block': 'slider_right', 'pink_block': 'table', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: push_pink_block_right
Video saved to: eval_log/trajectory_7.mp4
{'led': 0, 'lightbulb': 1, 'slider': 'right', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'slider_left', 'pink_block': 'slider_right', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: open_drawer
Video saved to: eval_log/trajectory_8.mp4
{'led': 1, 'lightbulb': 0, 'slider': 'left', 'drawer': 'open', 'red_block': 'table', 'blue_block': 'table', 'pink_block': 'slider_left', 'grasped': 0}
(200, 200, 3)
Processing task 1/1: push_red_block_left
Video saved to: eval_log/trajectory_9.mp4
{'led': 0, 'lightbulb': 1, 'slider': 'left', 'drawer': 'open', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'slider_left', 'grasped': 0}
{'led': 1, 'lightbulb': 0, 'slider': 'right', 'drawer': 'closed', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'slider_left', 'grasped': 0}
{'led': 1, 'lightbulb': 1, 'slider': 'right', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'slider_left', 'pink_block': 'table', 'grasped': 0}
{'led': 0, 'lightbulb': 0, 'slider': 'left', 'drawer': 'open', 'red_block': 'table', 'blue_block': 'slider_right', 'pink_block': 'slider_left', 'grasped': 0}
{'led': 1, 'lightbulb': 0, 'slider': 'right', 'drawer': 'closed', 'red_block': 'slider_left', 'blue_block': 'slider_right', 'pink_block': 'table', 'grasped': 0}
{'led': 0, 'lightbulb': 0, 'slider': 'right', 'drawer': 'closed', 'red_block': 'slider_left', 'blue_block': 'table', 'pink_block': 'table', 'grasped': 0}
{'led': 1, 'lightbulb': 1, 'slider': 'left', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'slider_left', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 0, 'lightbulb': 0, 'slider': 'left', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'slider_left', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 0, 'lightbulb': 0, 'slider': 'right', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'slider_right', 'pink_block': 'table', 'grasped': 0}
{'led': 0, 'lightbulb': 0, 'slider': 'right', 'drawer': 'open', 'red_block': 'table', 'blue_block': 'table', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 0, 'lightbulb': 0, 'slider': 'right', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'slider_left', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 0, 'lightbulb': 1, 'slider': 'left', 'drawer': 'open', 'red_block': 'table', 'blue_block': 'slider_left', 'pink_block': 'table', 'grasped': 0}
{'led': 0, 'lightbulb': 1, 'slider': 'right', 'drawer': 'closed', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'table', 'grasped': 0}
{'led': 0, 'lightbulb': 1, 'slider': 'right', 'drawer': 'closed', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'table', 'grasped': 0}
{'led': 1, 'lightbulb': 1, 'slider': 'left', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'table', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 1, 'lightbulb': 1, 'slider': 'right', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'slider_left', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 0, 'lightbulb': 0, 'slider': 'right', 'drawer': 'closed', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'slider_left', 'grasped': 0}
{'led': 0, 'lightbulb': 0, 'slider': 'right', 'drawer': 'open', 'red_block': 'table', 'blue_block': 'slider_left', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 1, 'lightbulb': 1, 'slider': 'right', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'table', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 0, 'lightbulb': 0, 'slider': 'right', 'drawer': 'closed', 'red_block': 'table', 'blue_block': 'table', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 1, 'lightbulb': 1, 'slider': 'right', 'drawer': 'open', 'red_block': 'table', 'blue_block': 'table', 'pink_block': 'slider_right', 'grasped': 0}
{'led': 1, 'lightbulb': 0, 'slider': 'left', 'drawer': 'open', 'red_block': 'table', 'blue_block': 'slider_right', 'pink_block': 'table', 'grasped': 0}
{'led': 1, 'lightbulb': 0, 'slider': 'right', 'drawer': 'open', 'red_block': 'slider_right', 'blue_block': 'table', 'pink_block': 'table', 'grasped': 0}
Traceback (most recent call last):
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/evaluation/multi_step_evaluation.py", line 199, in <module>
    evaluate_policy(policy,env,step_size,n_videos=10,eval_log_dir="eval_log", wandb_log=True)
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/evaluation/multi_step_evaluation.py", line 53, in evaluate_policy
    result, output = evaluate_sequence(env, model, step_size, task_oracle, initial_state, eval_sequence, val_annotations)
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/evaluation/multi_step_evaluation.py", line 145, in evaluate_sequence
    success, obss = rollout(env, model, step_size, task_checker, subtask, val_annotations)
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/evaluation/multi_step_evaluation.py", line 170, in rollout
    obs, _, _, current_info = env.step(action[s])
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/envs/play_table_env.py", line 289, in step
    obs = self.get_obs()
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/envs/play_table_env.py", line 242, in get_obs
    rgb_obs, depth_obs = self.get_camera_obs()
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/envs/play_table_env.py", line 235, in get_camera_obs
    rgb, depth = cam.render()
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/camera/static_camera.py", line 66, in render
    image = p.getCameraImage(
KeyboardInterrupt
Error in sys.excepthook:
Traceback (most recent call last):
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1719, in print
    extend(render(renderable, render_options))
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1344, in render
    yield from self.render(render_output, _options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1344, in render
    yield from self.render(render_output, _options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1340, in render
    for render_output in iter_render:
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/constrain.py", line 29, in __rich_console__
    yield from console.render(self.renderable, child_options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1340, in render
    for render_output in iter_render:
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/panel.py", line 230, in __rich_console__
    lines = console.render_lines(renderable, child_options, style=style)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1380, in render_lines
    lines = list(
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/segment.py", line 305, in split_and_crop_lines
    for segment in segments:
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1340, in render
    for render_output in iter_render:
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/padding.py", line 97, in __rich_console__
    lines = console.render_lines(
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1380, in render_lines
    lines = list(
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/segment.py", line 305, in split_and_crop_lines
    for segment in segments:
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1344, in render
    yield from self.render(render_output, _options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1344, in render
    yield from self.render(render_output, _options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/console.py", line 1340, in render
    for render_output in iter_render:
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/table.py", line 488, in __rich_console__
    widths = self._calculate_column_widths(
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/table.py", line 529, in _calculate_column_widths
    width_ranges = [
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/table.py", line 530, in <listcomp>
    self._measure_column(console, options, column) for column in columns
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/table.py", line 733, in _measure_column
    _min, _max = get_render_width(console, options, cell.renderable)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/measure.py", line 109, in get
    get_console_width(console, options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/padding.py", line 132, in __rich_measure__
    measure_min, measure_max = Measurement.get(console, options, self.renderable)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/measure.py", line 109, in get
    get_console_width(console, options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/panel.py", line 288, in __rich_measure__
    measure_renderables(
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/measure.py", line 144, in measure_renderables
    measurements = [
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/measure.py", line 145, in <listcomp>
    get_measurement(console, options, renderable) for renderable in renderables
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/measure.py", line 109, in get
    get_console_width(console, options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/table.py", line 332, in __rich_measure__
    self._calculate_column_widths(
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/table.py", line 529, in _calculate_column_widths
    width_ranges = [
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/table.py", line 530, in <listcomp>
    self._measure_column(console, options, column) for column in columns
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/table.py", line 733, in _measure_column
    _min, _max = get_render_width(console, options, cell.renderable)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/measure.py", line 109, in get
    get_console_width(console, options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/padding.py", line 132, in __rich_measure__
    measure_min, measure_max = Measurement.get(console, options, self.renderable)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/measure.py", line 109, in get
    get_console_width(console, options)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/pretty.py", line 342, in __rich_measure__
    pretty_str = pretty_repr(
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/pretty.py", line 912, in pretty_repr
    repr_str: str = node.render(
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/pretty.py", line 489, in render
    repr_str = "\n".join(str(line) for line in lines)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/pretty.py", line 489, in <genexpr>
    repr_str = "\n".join(str(line) for line in lines)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/rich/pretty.py", line 553, in __str__
    if self.last:
KeyboardInterrupt

Original exception was:
Traceback (most recent call last):
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/evaluation/multi_step_evaluation.py", line 199, in <module>
    evaluate_policy(policy,env,step_size,n_videos=10,eval_log_dir="eval_log", wandb_log=True)
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/evaluation/multi_step_evaluation.py", line 53, in evaluate_policy
    result, output = evaluate_sequence(env, model, step_size, task_oracle, initial_state, eval_sequence, val_annotations)
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/evaluation/multi_step_evaluation.py", line 145, in evaluate_sequence
    success, obss = rollout(env, model, step_size, task_checker, subtask, val_annotations)
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/evaluation/multi_step_evaluation.py", line 170, in rollout
    obs, _, _, current_info = env.step(action[s])
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/envs/play_table_env.py", line 289, in step
    obs = self.get_obs()
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/envs/play_table_env.py", line 242, in get_obs
    rgb_obs, depth_obs = self.get_camera_obs()
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/envs/play_table_env.py", line 235, in get_camera_obs
    rgb, depth = cam.render()
  File "/home/niklas/Desktop/Work/Projects/calvin_env_10/src/calvin_env_10/camera/static_camera.py", line 66, in render
    image = p.getCameraImage(
KeyboardInterrupt
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x7fb62601d7e0>
Traceback (most recent call last):
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/wandb/sdk/lib/service/service_connection.py", line 54, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/wandb/sdk/lib/service/service_connection.py", line 182, in teardown
    self._router.join()
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/site-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/home/niklas/anaconda3/envs/calvin_env_10/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt:
